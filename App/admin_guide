# ğŸ”§ Admin Panel Guide

## Was du bekommen hast

Ein **komplettes Admin Panel** fÃ¼r CalorieSnap mit:

âœ… **User Management** - Alle User sehen, verwalten, lÃ¶schen
âœ… **Analytics Dashboard** - Statistiken, Charts, Metriken
âœ… **Content Editor** - Landing Page bearbeiten
âœ… **Database Management** - Daten exportieren, backups

---

## ğŸš€ Admin Panel starten

### Option 1: Separater Start (Empfohlen)
```bash
streamlit run admin_launcher.py
```

### Option 2: Via URL Parameter
```bash
streamlit run app_new.py
# Dann Ã¶ffne: http://localhost:8501/?admin=true
```

---

## ğŸ” Admin Login

### Standard-Credentials (Ã„NDERN!)
```
Email: admin@caloriesnap.com
Passwort: admin123
```

### âš ï¸ WICHTIG: Credentials Ã¤ndern!

Ã–ffne `admin.py` und Ã¤ndere:

```python
# Zeile 13-14
ADMIN_EMAIL = "deine-admin-email@beispiel.com"
ADMIN_PASSWORD = "dein-sicheres-passwort"
```

---

## ğŸ“Š Features im Detail

### 1. Analytics Dashboard

**Ãœbersicht:**
- Total Users (Gesamt-Nutzer)
- Total Meals (Alle Mahlzeiten)
- Today's Meals (Heute geloggt)
- Total Calories (Gesamt Kalorien)

**Charts:**
- User Growth Chart (Wachstum Ã¼ber Zeit)
- Goal Distribution (Fitness-Ziele Verteilung)

---

### 2. User Management

**User-Tabelle:**
- Alle User mit Email, Name, Ziel
- Anzahl Mahlzeiten
- Durchschnittliche Kalorien
- Registrierungsdatum

**Funktionen:**
- ğŸ” Suche nach Email oder Name
- ğŸ—‘ï¸ User lÃ¶schen (inkl. alle Daten)
- ğŸ“Š User-Statistiken anzeigen

**Metriken:**
- Total Users
- Active Today
- Average Weight
- Most Popular Goal

---

### 3. Content Editor

**Hero Section bearbeiten:**
- Titel Ã¤ndern
- Untertitel Ã¤ndern
- Speichern (muss in app_new.py implementiert werden)

**Features Section:**
- 6 Feature-Karten bearbeiten
- Icons, Titel, Beschreibungen Ã¤ndern

**Color Theme:**
- Primary Color picker
- Secondary Color picker
- Accent Color picker
- CSS Code generieren

**WICHTIG:** Content-Ã„nderungen mÃ¼ssen in `app_new.py` hardcoded werden, da es keine Content-Datenbank gibt.

---

### 4. Database Management

**View Raw Data:**
- Users-Tabelle anzeigen
- Meals-Tabelle anzeigen
- Als CSV exportieren

**Bulk Operations:**
- Alte Mahlzeiten lÃ¶schen (Ã¤lter als X Tage)
- Automatische Cleanup

**Backup & Restore:**
- Komplettes Backup erstellen (JSON)
- Users + Meals exportieren
- Download-Button

---

## ğŸ¯ Typische Admin-Tasks

### User verwalten
```
1. Admin Panel Ã¶ffnen
2. Tab "Users"
3. Suche nach User
4. User lÃ¶schen falls nÃ¶tig
```

### Statistiken checken
```
1. Tab "Analytics"
2. Metriken anschauen
3. Charts analysieren
```

### Content Ã¤ndern
```
1. Tab "Content"
2. Texte bearbeiten
3. In app_new.py Ã¼bertragen
```

### Backup erstellen
```
1. Tab "Database"
2. "Backup & Restore"
3. "Create Backup" klicken
4. JSON downloaden
```

---

## ğŸ”’ Sicherheit

### Admin-Access beschrÃ¤nken

**Option 1: IP-Whitelist (fÃ¼r Production)**

Erstelle eine `.streamlit/config.toml`:
```toml
[server]
enableCORS = false
enableXsrfProtection = true
```

Dann in `admin.py` IP-Check hinzufÃ¼gen:
```python
import socket

ALLOWED_IPS = ["127.0.0.1", "deine-ip"]

def check_ip():
    hostname = socket.gethostname()
    ip = socket.gethostbyname(hostname)
    return ip in ALLOWED_IPS
```

**Option 2: Separate Admin-Domain**

Deploye Admin Panel auf separater Subdomain:
- Haupt-App: `caloriesnap.com`
- Admin: `admin.caloriesnap.com`

**Option 3: VPN-Only Access**

Nur Ã¼ber VPN erreichbar machen.

---

## ğŸš€ Deployment

### Render.com

**Separate Admin-Service erstellen:**

```yaml
Name: caloriesnap-admin
Build Command: pip install -r requirements.txt
Start Command: streamlit run admin_launcher.py --server.port=$PORT --server.address=0.0.0.0 --server.headless=true
```

**Environment Variables:**
```
ADMIN_EMAIL = deine-admin-email
ADMIN_PASSWORD = dein-passwort
```

Dann Credentials aus Environment laden:
```python
import os
ADMIN_EMAIL = os.getenv('ADMIN_EMAIL', 'admin@caloriesnap.com')
ADMIN_PASSWORD = os.getenv('ADMIN_PASSWORD', 'admin123')
```

---

## ğŸ“± Mobile Admin

Admin Panel ist auch mobile-optimiert:
- Responsive Design
- Touch-friendly
- Alle Features verfÃ¼gbar

---

## ğŸ†• Features erweitern

### Custom Analytics hinzufÃ¼gen

In `admin.py` â†’ `render_analytics_dashboard()`:

```python
# Beispiel: Durchschnittliche Mahlzeiten pro User
try:
    meals = supabase.table("meals").select("user_id").execute()
    users = supabase.table("users").select("user_id").execute()

    avg_meals = len(meals.data) / len(users.data) if users.data else 0

    st.metric("Avg Meals per User", f"{avg_meals:.1f}")
except Exception as e:
    st.error(f"Error: {e}")
```

### Email-Benachrichtigungen

FÃ¼ge Email-Funktion hinzu:
```python
import smtplib

def send_admin_notification(subject, message):
    # SMTP Configuration
    ...
```

### Auto-Reports

TÃ¤glich/WÃ¶chentlich Reports generieren:
```python
import schedule

def generate_weekly_report():
    stats = get_platform_stats()
    # Generate PDF report
    ...
```

---

## âš ï¸ Wichtige Hinweise

### Content-Ã„nderungen
- Ã„nderungen im Content Editor sind NICHT persistent
- Du musst sie manuell in `app_new.py` Ã¼bertragen
- FÃ¼r echtes CMS: Content-Tabelle in Supabase erstellen

### User-Deletion
- LÃ¶scht User UND alle Mahlzeiten (CASCADE)
- Unwiderruflich!
- Backup vorher erstellen

### Performance
- Bei 1000+ Users: Pagination hinzufÃ¼gen
- Charts kÃ¶nnten langsam werden
- Indexes in Supabase prÃ¼fen

---

## ğŸ› Troubleshooting

### "Permission denied"
- RLS Policies prÃ¼fen
- Service Role Key verwenden (nicht Anon Key)

### Charts laden nicht
- plotly installiert? `pip install plotly`
- Daten vorhanden?

### Login funktioniert nicht
- Credentials in `admin.py` Ã¼berprÃ¼fen
- Browser Cache lÃ¶schen

---

## ğŸ¨ Admin Panel customizen

### Eigenes Design

In `admin.py` CSS hinzufÃ¼gen:
```python
st.markdown("""
<style>
    /* Dein Custom CSS */
    .admin-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
</style>
""", unsafe_allow_html=True)
```

### Eigene Metriken

Neue Stat-Karten hinzufÃ¼gen:
```python
with col5:
    premium_users = len([u for u in users if u.get('is_premium')])
    st.metric("Premium Users", premium_users)
```

---

## ğŸ“š NÃ¤chste Schritte

1. **Credentials Ã¤ndern** (admin.py Zeile 13-14)
2. **Admin Panel testen** lokal
3. **Auf Render deployen** (optional)
4. **Custom Features** hinzufÃ¼gen

---

## ğŸ†˜ Support

Bei Fragen:
1. Check diese README
2. Supabase Dashboard Logs
3. Browser Console (F12)

---

**Admin Panel ist einsatzbereit! ğŸ‰**

Viel Erfolg beim Verwalten deiner CalorieSnap Platform! ğŸ’ª